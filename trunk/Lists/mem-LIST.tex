%%%%%
%%
%% This file sets up the Mem, MemFold, and MemEnvelope datatypes, and
%% creates possible macros for each.
%%
%% The Mem datatype isn't really used directly; it's there so the
%% other datatypes can inherit and share its code.
%%
%%%%%

\DECLARESUBTYPE{Mem}{Element}
\PRESETS{Mem}{
  %% \MYname is the trigger
  \F\MYtext	%%  text
  }


%%%%%
%% MemFold and MemEnvelope are both subtypes of Mem.  MemFold is for
%% fold-n-staple style mempackets, MemEnvelope is for stuff-n-seal
%% style mempackets.  If you want a mempacket to contain interesting
%% contents, like sheets, abilities, and other mempackets, use a
%% MemEnvelope.
\DECLARESUBTYPE{MemFold}{Mem}
\DECLARESUBTYPE{MemEnvelope}{Mem}


%%%%%
%% MemCover and MemPage are for the cover and pages of mempacket
%% booklets, which resemble research notebooks.  These are good
%% substitutes for large piles of MemFolds, and can be useful for
%% things like amnesiac characters.
%%
%% Like MemFolds, MemPages shouldn't directly own any other elements
%% as contents.  Use MemEnvelope instead.
%%
%% MemPages are usually assigned to a MemCover (via \MYmems), with the
%% MemCover representing the entire booklet and assigned to a
%% character.
%%
%% A MemCover is not a mempacket in and of itself; its name is not its
%% trigger and its text is not a memory.
\DECLARESUBTYPE{MemCover}{Mem}
\PRESETS{MemCover}{
  \sd\MYtext	{Each page is a memory/event packet with a separate
		trigger.}
  }

\DECLARESUBTYPE{MemPage}{Mem}


%%%%%
%% \memfold{<trigger>}{<text>}
%% \memenvelope{<trigger>}{<text>}
%% \memcover{<name>}{<pages>}
%% \mempage{<trigger>}{<text>}
%% \startmembook{<name>} <pages> \endmembook
%%
%% These are wrappers around \INSTANCE, useful as 1-shots.
%% \startmembook...\endmembook is a simple wrapper around \memcover
%% that may have better syntax for use within character sheets (inside
%% a \starttag{mems}...\endtag block).
\newinstance{MemFold}{\memfold[2]}{
  \s\MYname{#1}\s\MYtext{#2}}
\newinstance{MemEnvelope}{\memenvelope[2]}{
  \s\MYname{#1}\s\MYtext{#2}}
\newinstance{MemCover}{\memcover[2]}{
  \s\MYname{#1}\s\MYmems{#2}}
\newinstance{MemPage}{\mempage[2]}{
  \s\MYname{#1}\s\MYtext{#2}}

\long\def\startmembook#1#2\endmembook{\memcover{#1}{#2}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NEW{MemFold}{\mTest}{
  \s\MYname	{Test Trigger}
  \s\MYtext	{This is a Test of a fold-n-staple memory packet}
  }

  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%Willow's Mem-notebook
\NEW{MemCover}{\mExplosion}{
  \s\MYname	{$\alpha$ Packet}
  \s\MYmems	{\mExplosionPageOne{}\mExplosionPageTwo{}\mExplosionPageThree{}\mExplosionPageFour{}\mExplosionPageFive{}\mExplosionPageSix{}\mExplosionPageSeven{} \mExplosionPageEight{}}
  }

\NEW{MemPage}{\mExplosionPageOne}{
  \s\MYname	{Open when 30 minutes pass in game if your $\beta$ is 1.}
  \s\MYtext	{Go “not here” for 5 minutes - you are invisible and intangible. You can still hear and see everything around you, but cannot interact with it in any way.}
  }

\NEW{MemPage}{\mExplosionPageTwo}{
  \s\MYname	{Open when 1 hour passes in game if your $\beta$ is 1.}
  \s\MYtext	{Go mute for 10 minutes. At the end of this time, increase your $\alpha$ score to 2.}
  }

\NEW{MemPage}{\mExplosionPageThree}{
  \s\MYname	{Open when 1.5 hours pass in game if your $\beta$ is 1.}
  \s\MYtext	{You go blind for 2 minutes. You can blink your eyes open long enough to find a wall, but after that you must keep your eyes closed for 2 minutes.}
}

\NEW{MemPage}{\mExplosionPageFour}{
  \s\MYname	{Open when the banquet starts if your $\beta$ is 1.}
  \s\MYtext	{A group of friendly spirits that only you can see appear out of thin air and smile down at you. You can use them to heal any wounded person or to break any attack based restraint with a 30-count, after which they are totally fine. You can use this ability on yourself or someone else even if you are restrained or wounded yourself.}
}

\NEW{MemPage}{\mExplosionPageFive}{
  \s\MYname	{Open when 2.5 hours pass in game if your $\beta$ is 1.}
  \s\MYtext	{The friendly spirits have turned into demons dripping with blood! They’re out to kill you. run! Roleplay accordingly. If you are forced to stop moving (remember your \aRunAway{} ability), you are knocked out. After a minute, the ghosts dissipate.}
}

\NEW{MemPage}{\mExplosionPageSix}{
  \s\MYname	{Open when 3 hours pass in game if your $\beta$ is 1.}
  \s\MYtext	{Bolts of purple fire stream from your eyes and perform a CR 5 wound attack on the first two people you see (unassistable). If you can’t see two people, run around until you do. Tell people out of game that this is clearly beyond your control.

This is really serious. You need to find help for these people, and help for yourself, fast.}
}

\NEW{MemPage}{\mExplosionPageSeven}{
  \s\MYname	{Open when 3.5 hours pass in game if your $\beta$ is 1.}
  \s\MYtext	{You start to feel hot... REALLY hot. You think it would be a really, really good idea for everyone to get away from you right now - especially because you are rooted to the spot and cannot move. Open page 8 in 30 seconds.
   }
}

\NEW{MemPage}{\mExplosionPageEight}{
  \s\MYname	{Open when instructed to do so.}
  \s\MYtext	{You explode in a burst of radiant fireballs. You wound everyone within 3 ZOC of you (this is not considered combat, and cannot be resisted). Your body doesn’t exist anymore, so carry all of your items out of game and fill out a death report.}
}

%%Aldric's Tarot Book
\NEW{MemCover}{\mTarot}{
  \s\MYname	{Casting the Tarot}
  \s\MYmems	{\mPlant{}\mKing{}\mQueen{}\mGeneral{}\mWitch{}\mPriest{}\mPrincess{}\mAriel{}\mWillow{}\mManta{}\mDiplomat{}\mBodyguard{}\mPrince{}\mSpy{}}
  }

\NEW{MemPage}{\mPlant}{
  \s\MYname	{Open if you cast Tarot for badge 481.\\ Need: Death, Hanged Man, 481's ``Tarot Score''.}
  \s\MYtext	{DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH}
}

\NEW{MemPage}{\mKing}{
  \s\MYname	{Open if you cast Tarot for badge 531.\\ Need: The Emporer, The Tower, 531's ``Tarot Score''.}
  \s\MYtext	{The same \cWitch{\magician} who took your daughter comes now for your soul.}
  }

\NEW{MemPage}{\mQueen}{
  \s\MYname	{Open if you cast Tarot for badge 580.\\ Need: The High Priestess, The Empress, 580's ``Tarot Score''.}
  \s\MYtext	{Your lover plans to betray your country.}
  }

\NEW{MemPage}{\mGeneral}{
  \s\MYname	{Open if you cast Tarot for badge 598.\\ Need: The Empress, Strength, 598's ``Tarot Score''.}
  \s\MYtext	{Your lover is marked for death by an old friend.}
}

\NEW{MemPage}{\mWitch}{
  \s\MYname	{Open if you cast Tarot for badge 237.\\ Need: The Chariot. The Magician, 237's ``Tarot Score''.}
  \s\MYtext	{One of the cornerstones of your power is crumbling.}
}

\NEW{MemPage}{\mPriest}{
  \s\MYname	{Open if you cast Tarot for badge 312.\\ Need: The Hierophant, Death, 312's ``Tarot Score''.}
  \s\MYtext	{To ruin a \cAriel{\parent}, look to the child.}
}

\NEW{MemPage}{\mPrincess}{
  \s\MYname	{Open if you cast Tarot for badge 270.\\ Need:  Judgement, The Empress, 270's ``Tarot Score''.}
  \s\MYtext	{Your \cQueen{\parent} is alive but may not be for long.}
}

\NEW{MemPage}{\mAriel}{
  \s\MYname	{Open if you cast Tarot for badge 386.\\ Need: The Hermit, Wheel of Fortune, 386's ``Tarot Score''.}
  \s\MYtext	{This is no longer your world. Something has rotted within the Explorer's Guild.}
}

\NEW{MemPage}{\mWillow}{
  \s\MYname	{Open if you cast Tarot for badge 143.\\ Need: The Fool, The High Priestess, 143's ``Tarot Score''.}
  \s\MYtext	{You are in great danger from magic, but it is also your greatest opportunity.}
}

\NEW{MemPage}{\mManta}{
  \s\MYname	{Open if you cast Tarot for badge 615.\\ Need: The Hanged Man, The Magician, 615's ``Tarot Score''.}
  \s\MYtext	{The Tarot reveals your true intentions. Act quickly, or your opportunity may be lost.}
}

\NEW{MemPage}{\mDiplomat}{
  \s\MYname	{Open if you cast Tarot for badge 276.\\ Need: The Lovers, The Tower, 276's ``Tarot Score''.}
  \s\MYtext	{Great military tacticians know more than one way to remove someone from the picture.}
}

\NEW{MemPage}{\mBodyguard}{
  \s\MYname	{Open if you cast Tarot for badge 397.\\ Need: The World, Strength, 397's ``Tarot Score''.}
  \s\MYtext	{The safety of all you hold dear rests with you. Knowledge is power.}
}

\NEW{MemPage}{\mPrince}{
  \s\MYname	{Open if you cast Tarot for badge 271.\\ Need: Temperance, The Chariot, 271's ``Tarot Score''.}
  \s\MYtext	{The \cKing{\King} is being influenced by a trusted adviser. As long as they are in the way, the treaty is in danger.}
}

\NEW{MemPage}{\mSpy}{
  \s\MYname	{Open if you cast Tarot for badge 347.\\ Need: The Sun, The Fool, 347's ``Tarot Score''.}
  \s\MYtext	{Your salvation lies in the hands of a human.}
}

%%King Triton's Mem-notebook
\NEW{MemCover}{\mDepression}{
  \s\MYname	{Depression Packet}
  \s\MYmems	{\mDepressionPageOne{}\mDepressionPageTwo{}\mDepressionPageThree{}\mDepressionPageFour{}\mDepressionPageFive{}\mDepressionPageSix{}\mDepressionPageSeven{}}
  }

%%ThreeThirty
\NEW{MemPage}{\mDepressionPageOne}{
  \s\MYname	{Open at 5:30 pm if your $\beta$ is 6 or higher and no treaty has reached the Complete state this game (negative).}
  \s\MYtext	{You're never going to get the treaty signed at this rate! Decrease your $\beta$ by 2.}
}
	
\NEW{MemPage}{\mDepressionPageTwo}{
  \s\MYname	{Open if either Willow or Ariel expresses a desire to stay (positive).}
  \s\MYtext	{Your heart is warmed with love for your family. Increase your $\beta$ by 2.}
}
		
\NEW{MemPage}{\mDepressionPageThree}{
  \s\MYname	{Open if you dance Merengue in game. (positive)}
  \s\MYtext	{Your dancing reminds you of happier times. Increase your $\beta$ by 2.}
}
	
\NEW{MemPage}{\mDepressionPageFour}{
  \s\MYname	{If anyone outside of your family finds out about your depression (negative).}
  \s\MYtext	{How embarrassing{\ldots} Decrease your $\beta$ by 2.}
}
	
\NEW{MemPage}{\mDepressionPageFive}{
  \s\MYname	{Open if you see a purple headband. (???)}
  \s\MYtext	{It's your \cQueen{\spouse}! \cQueen{\they}'s alive?!? That's amazing! Increase your $\beta$ score by 2.
	
	Wait...  \cQueen{\they}'s alive... but didn't \cQueen{\they} walk in with \cGeneral{}? Confront \cQueen{\them} about this, then open page 6.}	
}

\NEW{MemPage}{\mDepressionPageSix}{
  \s\MYname	{Do not open until instructed to do so. (???)}
  \s\MYtext	{\cQueen{\They}'s been cheating on you all of this time? That's soul crushing. Decrease your $\beta$ score by 4.
	
	\cQueen{\They} should be with you! If you can get \cQueen{\them} to renounce \cGeneral{} and come back to you, open page 7.}
}
	
\NEW{MemPage}{\mDepressionPageSeven}{
  \s\MYname	{Do not open until instructed to do so. (Positive)}
  \s\MYtext	{You have some issues to work out between you, but for now, you're just glad that \cQueen{\they}'s back. Increase your $\beta$ score by 6, and if this brings you over your cap, increase your cap to compensate.}
}

%%Individual mempackets

%Manta from desara
\NEW{MemFold}{\mWPacket}{
  \s\MYname	{W packet}
  \s\MYtext	{\cSpy{} is clearly researching the history of the war -- your past. \cSpy{\They} might be the key to proving that \cExExKing{} kidnapped and raped your \cMother{\parent}, leading to your conception..}
}

\NEW{MemFold}{\mWillowNote}{
  \s\MYname	{Open at 3:00}
  \s\MYtext	{You feel a surge of power. There's definitely a dangerous budding magician here with uncontrolled magic. You need to find them.}
}

%%Break spell
\NEW{MemFold}{\mLovePacket}{
  \s\MYname	{Open if 30 minutes pass without you hearing the words ``I love you always and forever'' from your lover.}
  \s\MYtext	{The spell is broken. Your free will is restored and all compulsion is gone. Lose the goal: ``Find some way to remain with \cWitch{} once the ball concludes.''. Destroy the item card ``\iLoveSpell{}''.}
}

%The Queen!
\NEW{MemFold}{\mQPacketGeneric}{
  \s\MYname	{Open if you see a purple headband}
  \s\MYtext	{Holy shit! That's \cQueen{\King} \cAthena{}! \cQueen{\They}'s been missing for 21 years!}
 }

\NEW{MemFold}{\mQPacketManta}{
  \s\MYname	{Open if you see a purple headband}
  \s\MYtext	{Damn, \cQueen{\they}'s revealed \cQueen{\their}self. This will make it much harder to get rid of \cQueen{\their}...}
 }
 
\NEW{MemFold}{\mQPacketGladius}{
  \s\MYname	{Open if you see a purple headband}
  \s\MYtext	{Oh shit. \cQueen{} has revealed herself as \cAthena{}. \cKing{} is going to be pissed, and you may very well lose her}
 }
 
\NEW{MemEnvelope}{\mREnvelope}{
  \s\MYname	{R Envelope}
  \s\MYtext	{Open only when instructed to.}
  \s\MYabils	{\aSummonGuards{}}
}
