%%%%%
%%
%% This file sets up the Mem, MemFold, and MemEnvelope datatypes, and
%% creates possible macros for each.
%%
%% The Mem datatype isn't really used directly; it's there so the
%% other datatypes can inherit and share its code.
%%
%%%%%

\DECLARESUBTYPE{Mem}{Element}
\PRESETS{Mem}{
  %% \MYname is the trigger
  \F\MYtext	%%  text
  }


%%%%%
%% MemFold and MemEnvelope are both subtypes of Mem.  MemFold is for
%% fold-n-staple style mempackets, MemEnvelope is for stuff-n-seal
%% style mempackets.  If you want a mempacket to contain interesting
%% contents, like sheets, abilities, and other mempackets, use a
%% MemEnvelope.
\DECLARESUBTYPE{MemFold}{Mem}
\DECLARESUBTYPE{MemEnvelope}{Mem}


%%%%%
%% MemCover and MemPage are for the cover and pages of mempacket
%% booklets, which resemble research notebooks.  These are good
%% substitutes for large piles of MemFolds, and can be useful for
%% things like amnesiac characters.
%%
%% Like MemFolds, MemPages shouldn't directly own any other elements
%% as contents.  Use MemEnvelope instead.
%%
%% MemPages are usually assigned to a MemCover (via \MYmems), with the
%% MemCover representing the entire booklet and assigned to a
%% character.
%%
%% A MemCover is not a mempacket in and of itself; its name is not its
%% trigger and its text is not a memory.
\DECLARESUBTYPE{MemCover}{Mem}
\PRESETS{MemCover}{
  \sd\MYtext	{Each page is a memory/event packet with a separate
		trigger.}
  }

\DECLARESUBTYPE{MemPage}{Mem}


%%%%%
%% \memfold{<trigger>}{<text>}
%% \memenvelope{<trigger>}{<text>}
%% \memcover{<name>}{<pages>}
%% \mempage{<trigger>}{<text>}
%% \startmembook{<name>} <pages> \endmembook
%%
%% These are wrappers around \INSTANCE, useful as 1-shots.
%% \startmembook...\endmembook is a simple wrapper around \memcover
%% that may have better syntax for use within character sheets (inside
%% a \starttag{mems}...\endtag block).
\newinstance{MemFold}{\memfold[2]}{
  \s\MYname{#1}\s\MYtext{#2}}
\newinstance{MemEnvelope}{\memenvelope[2]}{
  \s\MYname{#1}\s\MYtext{#2}}
\newinstance{MemCover}{\memcover[2]}{
  \s\MYname{#1}\s\MYmems{#2}}
\newinstance{MemPage}{\mempage[2]}{
  \s\MYname{#1}\s\MYtext{#2}}

\long\def\startmembook#1#2\endmembook{\memcover{#1}{#2}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NEW{MemFold}{\mTest}{
  \s\MYname	{Test Trigger}
  \s\MYtext	{This is a Test of a fold-n-staple memory packet}
  }

  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%Potions
\NEW{MemFold}{\mLatentPoisonEffect}{
  \s\MYname	{Open immediately once you return to game.}
  \s\MYtext	{You have been poisoned! You are slightly nauseous, now mute, and will die in 5 minutes if you do not receive medical attention or consume a healing potion. If you do either of these things, you are cured-- you won't die and are no longer mute.}
  }

\NEW{MemFold}{\mDeadlyPoisonEffect}{
  \s\MYname	{Open immediately once you return to game.}
  \s\MYtext	{You have been poisoned! The poison is very powerful and will kill you in 10 minutes. Since you are moderately nauseous, your CR drops to zero (and cannot be increased) and you must walk heel to toe. Only an exceptionally powerful magical artifact (\iWishingStone{\MYnumber}) can save you.}
  }

%%Willow's Mem-notebook
\NEW{MemCover}{\mExplosion}{
  \s\MYname	{$\alpha$ Packet}
  \s\MYmems	{\mExplosionPageOne{}\mExplosionPageTwo{}\mExplosionPageThree{}\mExplosionPageFour{}\mExplosionPageFive{}\mExplosionPageSix{}\mExplosionPageSeven{}}
  }

\NEW{MemPage}{\mExplosionPageOne}{
  \s\MYname	{Open when 30 minutes pass in game if your $/Beta$ is 1.}
  \s\MYtext	{Go “not here” for 5 minutes - you are invisible and intangible. You can still hear and see everything around you, but cannot interact with it in any way.}
  }

\NEW{MemPage}{\mExplosionPageTwo}{
  \s\MYname	{Open when 1 hour passes in game if your $/Beta$ is 1.}
  \s\MYtext	{Go mute for 10 minutes. At the end of this time, increase your $\alpha$ score to 2.}
  }

\NEW{MemPage}{\mExplosionPageThree}{
  \s\MYname	{Open when 1.5 hours pass in game if your $/Beta$ is 1.}
  \s\MYtext	{You go blind for 2 minutes. You can blink your eyes open long enough to find a wall, but after that you must keep your eyes closed for 2 minutes.}
}

\NEW{MemPage}{\mExplosionPageFour}{
  \s\MYname	{Open when the banquet starts if your $/Beta$ is 1.}
  \s\MYtext	{A group of friendly spirits that only you can see appear out of thin air and smile down at you. You can use them to heal any wounded person or to break any attack based restraint with a 30-count, after which they are totally fine. You can use this ability on yourself or someone else even if you are restrained or wounded yourself.}
}

\NEW{MemPage}{\mExplosionPageFive}{
  \s\MYname	{Open when 2.5 hours pass in game if your $/Beta$ is 1.}
  \s\MYtext	{The friendly spirits have turned into demons dripping with blood! They’re out to kill you. run! Roleplay accordingly. If you are forced to stop moving (remember your \aRunAway{} ability), you are knocked out. After a minute, the ghosts dissipate.}
}

\NEW{MemPage}{\mExplosionPageSix}{
  \s\MYname	{Open when 3 hours pass in game if your $/Beta$ is 1.}
  \s\MYtext	{Bolts of purple fire stream from your eyes and perform a CR 5 wound attack on the first two people you see (unassistable). If you can’t see two people, run around until you do. Tell people out of game that this is clearly beyond your control.

This is really serious. You need to find help for these people, and help for yourself, fast.}
}

\NEW{MemPage}{\mExplosionPageSeven}{
  \s\MYname	{Open when 3.5 hours pass in game if your $/Beta$ is 1.}
  \s\MYtext	{You explode in a burst of radiant fireballs. You wound everyone within 3 ZOC of you (this is not considered combat, and cannot be resisted). Your body doesn’t exist anymore, so carry all of your items out of game and fill out a death report.}
}

%%Aldric's Tarot BOok
\NEW{MemCover}{\mTarot}{
  \s\MYname	{Casting the Tarot}
  \s\MYmems	{\mPlant{}\mKing{}\mQueen{}\mGeneral{}\mWitch{}\mPriest{}\mPrincess{}\mAriel{}\mWillow{}\mManta{}\mDiplomat{}\mBodyguard{}\mPrince{}\mSpy{}}
  }

\NEW{MemPage}{\mPlant}{
  \s\MYname	{Open if you cast Tarot for badge 481.\\ Need: Death, Hanged Man, 481's ``Tarot Score''.}
  \s\MYtext	{DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH
DEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATHDEATH}
}

\NEW{MemPage}{\mKing}{
  \s\MYname	{Open if you cast Tarot for badge 531.\\ Need: The Emporer, The Tower, 531's ``Tarot Score''.}
  \s\MYtext	{Someone you trust is trying to bring down your rule.}
  }

\NEW{MemPage}{\mQueen}{
  \s\MYname	{Open if you cast Tarot for badge 580.\\ Need: The High Priestess, The Empress, 580's ``Tarot Score''.}
  \s\MYtext	{Your lover plans to betray your country.}
  }

\NEW{MemPage}{\mGeneral}{
  \s\MYname	{Open if you cast Tarot for badge 598.\\ Need: The Empress, Strength, 598's ``Tarot Score''.}
  \s\MYtext	{Your lover is marked for death by an old friend.}
}

\NEW{MemPage}{\mWitch}{
  \s\MYname	{Open if you cast Tarot for badge 237.\\ Need: The Chariot. The Magician, 237's ``Tarot Score''.}
  \s\MYtext	{One of the cornerstones of your power is crumbling.}
}

\NEW{MemPage}{\mPriest}{
  \s\MYname	{Open if you cast Tarot for badge 312.\\ Need: The Hierophant, Death, 312's ``Tarot Score''.}
  \s\MYtext	{To ruin a \cAriel{\parent}, look to the child.}
}

\NEW{MemPage}{\mPrincess}{
  \s\MYname	{Open if you cast Tarot for badge 270.\\ Need:  Judgement, The Empress, 270's ``Tarot Score''.}
  \s\MYtext	{Your \cQueen{\parent} is alive but may not be for long.}
}

\NEW{MemPage}{\mAriel}{
  \s\MYname	{Open if you cast Tarot for badge 386.\\ Need: The Hermit, Wheel of Fortune, 386's ``Tarot Score''.}
  \s\MYtext	{This is no longer your world. Something has rotted within the Explorer's Guild.}
}

\NEW{MemPage}{\mWillow}{
  \s\MYname	{Open if you cast Tarot for badge 143.\\ Need: The Fool, The High Priestess, 143's ``Tarot Score''.}
  \s\MYtext	{You are in great danger from magic, but it is also your greatest opportunity.}
}

\NEW{MemPage}{\mManta}{
  \s\MYname	{Open if you cast Tarot for badge 615.\\ Need: The Hanged Man, The Magician, 615's ``Tarot Score''.}
  \s\MYtext	{The Tarot reveals your true intentions. Act quickly, or your opportunity may be lost.}
}

\NEW{MemPage}{\mDiplomat}{
  \s\MYname	{Open if you cast Tarot for badge 276.\\ Need: The Lovers, The Tower, 276's ``Tarot Score''.}
  \s\MYtext	{Great military tacticians know more than one way to remove someone from the picture.}
}

\NEW{MemPage}{\mBodyguard}{
  \s\MYname	{Open if you cast Tarot for badge 397.\\ Need: The World, Strength, 397's ``Tarot Score''.}
  \s\MYtext	{The safety of all you hold dear rests with you. Knowledge is power.}
}

\NEW{MemPage}{\mPrince}{
  \s\MYname	{Open if you cast Tarot for badge 271.\\ Need: Temperance, The Chariot, 271's ``Tarot Score''.}
  \s\MYtext	{The \cKing{\King} is being influenced by a trusted adviser. As long as they are in the way, the treaty is in danger.}
}

\NEW{MemPage}{\mSpy}{
  \s\MYname	{Open if you cast Tarot for badge 347.\\ Need: The Sun, The Fool, 347's ``Tarot Score''.}
  \s\MYtext	{Your salvation lies in the hands of a human.}
}

\NEW{MemEnvelope}{\mREnvelope}{
  \s\MYname	{$\R$ Envelope}
  \s\MYtext	{Open when instructed to.}
  \s\MYabils	{\aSummonGuards{}}
}

\NEW{MemFold}{\mWPacket}{
  \s\MYname	{W packet}
  \s\MYtext	{\cSpy{} is clearly researching the history of the war -- your past. \cSpy{\They} might be the key to proving that \cExExKing{} kidnapped and raped your \cMother{\parent}, leading to your conception.}
  }